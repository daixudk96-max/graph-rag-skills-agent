C:\Python311\Lib\site-packages\torch\cuda\__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: status)} {position: line: 4, column: 61, offset: 116} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: summary)} {position: line: 6, column: 23, offset: 198} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: full_content)} {position: line: 18, column: 29, offset: 565} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: created_at)} {position: line: 5, column: 26, offset: 161} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownRelationshipTypeWarning} {category: UNRECOGNIZED} {title: The provided relationship type is not in the database.} {description: One of the relationship types in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing relationship type is: HAS_DELTA)} {position: line: 4, column: 26, offset: 81} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: __CommunityDelta__)} {position: line: 4, column: 41, offset: 96} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: full_content)} {position: line: 11, column: 29, offset: 367} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: level)} {position: line: 3, column: 17, offset: 41} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: __Community__)} {position: line: 2, column: 10, offset: 14} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: summary)} {position: line: 11, column: 45, offset: 383} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: id)} {position: line: 8, column: 24, offset: 262} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: summary)} {position: line: 18, column: 45, offset: 581} for query: "\n    MATCH (c:__Community__)\n    WHERE c.level = $level\n    OPTIONAL MATCH (c)-[:HAS_DELTA]->(d:__CommunityDelta__ {status: 'pending'})\n    WITH c, d ORDER BY d.created_at ASC\n    WITH c, collect(d.summary) AS delta_summaries\n    RETURN {\n        communityId: c.id, \n        full_content: CASE \n            WHEN size(delta_summaries) > 0 \n            THEN coalesce(c.full_content, c.summary, '') + \n                 '\n\n[Recent Updates]:\n' + \n                 reduce(s = '', item IN delta_summaries | s + '- ' + coalesce(item, '') + '\n')\n            ELSE coalesce(c.full_content, c.summary, '')\n        END\n    } AS output\n    LIMIT 5\n    "

============================================================
DSA End-to-End Integration Tests
============================================================

[PASS] test_dsa_configuration
[FAIL] test_delta_summarizer_initialization: Expected a Runnable, callable or dict.Instead got an unsupported type: <class '__main__.MockLLM'>
[FAIL] test_community_compactor_initialization: Expected a Runnable, callable or dict.Instead got an unsupported type: <class '__main__.MockLLM'>
[FAIL] test_check_compaction_needed: Expected a Runnable, callable or dict.Instead got an unsupported type: <class '__main__.MockLLM'>
  Query returned 0 communities
[PASS] test_read_path_query_syntax
[PASS] test_base_summarizer_mode_parameter
[FAIL] test_delta_store_and_retrieve: Expected a Runnable, callable or dict.Instead got an unsupported type: <class '__main__.MockLLM'>

============================================================
Results: 3 passed, 4 failed
============================================================

